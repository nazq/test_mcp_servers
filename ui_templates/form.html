<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"><title>Form App</title></head>
<body style="margin:0;padding:16px;font-family:system-ui;background:#fff">
  <h3 style="margin:0 0 12px">Contact Form Test</h3>
  <p id="tool-result" style="color:#555;margin:0 0 12px;font-size:14px">Waiting for tool result...</p>
  <form id="contact-form" style="display:flex;flex-direction:column;gap:10px;max-width:300px">
    <label style="font-size:14px;color:#555">
      Name
      <input id="name" type="text" placeholder="Enter name"
        style="display:block;width:100%;padding:8px;border:1px solid #d1d5db;border-radius:6px;margin-top:4px;box-sizing:border-box">
    </label>
    <label style="font-size:14px;color:#555">
      Email
      <input id="email" type="email" placeholder="Enter email"
        style="display:block;width:100%;padding:8px;border:1px solid #d1d5db;border-radius:6px;margin-top:4px;box-sizing:border-box">
    </label>
    <button type="submit"
      style="padding:10px 20px;background:#7c3aed;color:white;border:none;border-radius:8px;cursor:pointer;font-size:15px;margin-top:4px">
      Save Contact
    </button>
  </form>
  <p id="status" style="color:#888;margin-top:12px;font-size:14px"></p>
  <script>
  // {{MCP_APP_SHIM}}
  </script>
  <script>
    var app = new McpApp('Form App', '1.0.0');

    app.ontoolresult = function(result) {
      var text = '(no content)';
      if (result && result.content) {
        for (var i = 0; i < result.content.length; i++) {
          if (result.content[i].type === 'text') {
            text = result.content[i].text;
            break;
          }
        }
      }
      document.getElementById('tool-result').textContent = 'Tool result: ' + text;
    };

    app.connect().then(function() {
      document.getElementById('status').textContent = 'Connected to host.';
    });

    document.getElementById('contact-form').addEventListener('submit', function(e) {
      e.preventDefault();
      var name = document.getElementById('name').value;
      var email = document.getElementById('email').value;

      app.callServerTool('concat', { strings: [name, ' <', email, '>'] })
        .then(function(result) {
          var text = '(no response)';
          if (result && result.content) {
            for (var i = 0; i < result.content.length; i++) {
              if (result.content[i].type === 'text') {
                text = result.content[i].text;
                break;
              }
            }
          }
          document.getElementById('status').textContent = 'Saved: ' + text;
          document.getElementById('status').style.color = '#7c3aed';
        })
        .catch(function(err) {
          document.getElementById('status').textContent = 'Error: ' + (err.message || JSON.stringify(err));
          document.getElementById('status').style.color = '#dc2626';
        });
    });
  </script>
</body>
</html>
